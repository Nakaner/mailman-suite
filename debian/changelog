mailman-suite (0+20170523-12) unstable; urgency=medium

  [ Jonas Meurer ]
  * Rename binary package 'mailman3-suite' to 'mailman3-web' to avoid
    further confusion.
  * Move logfiles to new subdirectory /var/log/mailman3/web
  * d/rules:
    - Set owner of /var/lib/mailman3/web/static/CACHE to www-data:www-data.
      (Closes: #892427)
    - Run debhelper with '--with systemd'
  * d/control:
    - Drop binary package 'mailman3', will be provided by another source
      package in future.
    - Add 'Conflicts: mailman3-suite' to mailman3-web, to prevent parallel
      installation of old and new binary package.
    - Add transitional package 'mailman3-suite' that depends on new package
      'mailman3-web'
  * d/mailman3-web.postinst:
    - Add '-f' to ucfr for hyperkitty.conf, as we might hijack the file from
      old package mailman3-suite.
  * d/mailman3-suite.{preinst,postrm}:
    - Stop obsolete service and remove obsolete files from mailman3-suite
  * d/NEWS:
    - Document the renaming of the binary package name.
  * d/contrib/hyperkitty.cfg.sample:
     - Fix URL to hyperkitty (http://localhost/mailman3/hyperkitty/ per
       default)

  [ Pierre-Elliott Bécue ]
  * mailman3-web.install: move uwsgi.ini to /etc/mailman3
  * Add nginx.conf file.
  * Fix mailman3-web.cron.d jobs to call explicitly python2.7 version of
    django-admin.py

 -- Jonas Meurer <jonas@freesources.org>  Mon, 12 Mar 2018 12:57:48 +0100

mailman-suite (0+20170523-11) unstable; urgency=medium

  [ Jonas Meurer ]
  * d/control:
    - Fix alternative dependency on 'python-mysqldb'. We need the python2
      version here as the django parts of mailman3 are still python2.
  * d/README.Debian:
    - Update paragraph about 'MySQL database backend'.
  * d/mailman3-suite.config:
    - Fix dbc_dbname for SQLite database backend.
  * d/mailman3-suite.postinst:
    - Run django-admin commands as user 'www-data'. (Closes: #891703)
    - Only touch+chown logfiles if they don't exist yet.
    - Fix dbc_dbname for SQLite database backend.
  * d/mailman3-suite.postrm:
    - Remove mailman-suite logfiles at purge.
  * d/mailman3-suite.cron.d:
    - Run mailman3-suite cronjobs as user 'www-data'. The uwsgi daemon runs
      as 'www-data', so the corresponding cronjobs should do so as well.
      (Closes: #891849)
  * d/rules:
    - Set owner for whole '/var/lib/mailman3/suite/static' to www-data.
  * Move data directory from '/var/lib/mailman3/web' to
    '/var/lib/mailman3/suite' to better match package name.

  [ Pierre-Elliott Bécue ]
  * d/README.Debian:
    - Fix typo

 -- Jonas Meurer <jonas@freesources.org>  Sat, 03 Mar 2018 12:58:21 +0100

mailman-suite (0+20170523-10) unstable; urgency=high

  * d/control:
    - Update Vcs-* fields to point to new repository on salsa.debian.org.
  * d/mailman3-suite.postrm:
    - Source apache2-maintscript-helper at the beginning of postrm to pass
      all arguments to it. (Closes: #891553)
    - Always remove the Apache mailman3.conf symlink, regardless of whether
      apache2-maintscript-helper was found.

 -- Jonas Meurer <jonas@freesources.org>  Tue, 27 Feb 2018 15:02:06 +0100

mailman-suite (0+20170523-9) unstable; urgency=medium

  * d/mailman3-suite.config: Fix typo, use debconf question
    'mailman3-suite/database-type' not 'mailman3-core/database-type'.

 -- Jonas Meurer <jonas@freesources.org>  Wed, 24 Jan 2018 07:53:31 +0100

mailman-suite (0+20170523-8) unstable; urgency=medium

  [ Pierre-Elliott Bécue ]
  * d/control:
    - Remove dependency on mailman3-core for mailman3-suite.
    - Update description of mailman3 metapackage.

  [ Jonas Meurer ]
  * d/mailman3-suite.config:
    - Change default database backend to 'sqlite3'. Required to fix non-
      interactive installations without recommends (e.g. piuparts).
  * d/README.Debian:
    - Add a section about selection of the database backend.
  * d/control:
    - Update description of mailman3-suite package to reflect the fact
      that several database backends are supported and 'sqlite3' is the
      default.
    - Degrade recommends on postgresql|mysql to suggests now that we use
      sqlite3 as default database backend. We don't want to pull in needless
      extra database servers.
    - Set Rules-Requires-Root: binary-targets.

 -- Jonas Meurer <jonas@freesources.org>  Tue, 16 Jan 2018 15:07:39 +0100

mailman-suite (0+20170523-7) unstable; urgency=medium

  [ Pierre-Elliott Bécue ]
  * d/po/fr.po reviewed.

  [ Jonas Meurer ]
  * d/mailman3-suite.prerm: Move 'dbc_go' behind the '#DEBHELPER' section.
    Database removal has to happen after service is stopped to prevent
    race conditions.
  * Add multi database backend support in maintainer scripts with dbconfig:
    * Change default database backend in the configuration skeleton to
      SQLite3. This ensures a working setup without dbconfig.
    * PostgreSQL (the upstream recommendation) stays the default at debconf
      database backend selection. This also applies for non-interactive
      installations.
    * Move SQLite3 database file to '/var/lib/mailman3/web/mailman3suite.db',
      manage it with dbconfig.
    * Unfortunately, using MySQL as backend is broken with MariaDB packages
      in Debian between 10.0.22-2 and 10.2.7-1 as they use 'utf8mb4' as
      default character set but don't have 'innodb_large_prefix' and
      row format 'dynamic' yet. See bug #886756 for further information.
      If you want to use MariaDB as database backend, you'll have to use
      MariaDB <= 10.0.22-1 or >= 10.2.7-1 for now.
  * d/control: Bump standards-version to 4.1.3, no changes required.
  * d/mailman3-suite.postinst: Change order of actions. First create config
    and log files, then run django-admin and finally (optionally) configure
    webservers.
  * d/templates: Change the webserver selection from multiselect to select,
    making 'none' the default. This fixes non-interactive installations and
    those without installed Apache2. (Closes: #884835)
  * d/mailman3-suite.postrm: Run 'db_purge' to clean up debconf database.

 -- Jonas Meurer <jonas@freesources.org>  Wed, 10 Jan 2018 00:58:24 +0100

mailman-suite (0+20170523-6) unstable; urgency=medium

  * d/mailman3-suite.init: Fix stop and reload functions by sending the right
    signals to the uwsgi daemon for stopping/killing/reloading it. Thanks
    again to Stephen Rothwell for bugreport and debugging. (Closes: #884330)

 -- Jonas Meurer <jonas@freesources.org>  Fri, 15 Dec 2017 14:38:12 +0100

mailman-suite (0+20170523-5) unstable; urgency=medium

  * d/mailman3-suite.init: Fix order of variable definitions. Thanks to
    Stephen Rothwell for the bugreport. (Closes: #884326)

 -- Jonas Meurer <mejo@debian.org>  Thu, 14 Dec 2017 00:16:09 +0100

mailman-suite (0+20170523-4) unstable; urgency=medium

  * d/mailman3-suite.init: Fix typo in do_stop() function. Thanks to Stephen
    Rothwell for the bugreport. (Closes: #884325)

 -- Jonas Meurer <mejo@debian.org>  Wed, 13 Dec 2017 23:56:28 +0100

mailman-suite (0+20170523-3) unstable; urgency=medium

  * d/control: fix a typo in Recommends: field. (Closes: #884316)

 -- Pierre-Elliott Bécue <becue@crans.org>  Wed, 13 Dec 2017 22:38:35 +0100

mailman-suite (0+20170523-2) unstable; urgency=medium

  [ Pierre-Elliott Bécue ]
  * d/control: fix vcs items to solve vcswatch complaints.
  * Adds missing dependency to mailman3: python3-mailman-hyperkitty
  * Uses pipes as sed delimiters to avoid some wrongdoings with variables
    filled with base64. (Closes: #884259)

  [ Jonas Meurer ]
  * d/control: bump standards-version to 4.1.2, no changes needed.

 -- Jonas Meurer <mejo@debian.org>  Wed, 13 Dec 2017 07:52:24 +0100

mailman-suite (0+20170523-1) unstable; urgency=medium

  [ Jonas Meurer ]
  * Initial release. (Closes: #799292, #877878)
  * Package based on upstream Git commit cd1b5856 from May 23rd 2017.

  [ Pierre-Elliott Bécue ]
  * French translation for debconf template.

 -- Jonas Meurer <mejo@debian.org>  Sun, 12 Nov 2017 23:04:45 +0100
